16:59:10   Config file: config/knowledge_graph/lnctard.yaml
16:59:10   {'dataset': {'class': 'LncTarD',
             'include_factgraph': False,
             'path': '/home/linkpred/NBFNet/data/lnctard'},
 'engine': {'batch_size': 32, 'gpus': [0]},
 'metric': 'mrr',
 'optimizer': {'class': 'Adam', 'lr': 0.005},
 'output_dir': 'results/LncTarD',
 'task': {'adversarial_temperature': 0.5,
          'class': 'KnowledgeGraphCompletion',
          'criterion': 'bce',
          'model': {'aggregate_func': 'pna',
                    'class': 'NBFNet',
                    'dependent': True,
                    'hidden_dims': [32, 32, 32, 32, 32, 32],
                    'input_dim': 32,
                    'layer_norm': True,
                    'message_func': 'distmult',
                    'short_cut': True,
                    'symmetric': True},
          'num_negative': 32,
          'sample_weight': False,
          'strict_negative': True},
 'train': {'batch_per_epoch': 100, 'num_epoch': 20}}
16:59:10   LncTarD(
  #entity: 2963
  #relation: 7
  #triplet: 6580
)
16:59:10   #train: 5264, #valid: 658, #test: 658
16:59:10   Preprocess training set
16:59:12   {'batch_size': 32,
 'class': 'core.Engine',
 'gpus': [0],
 'gradient_interval': 1,
 'log_interval': 100,
 'logger': 'logging',
 'num_worker': 0,
 'optimizer': {'amsgrad': False,
               'betas': (0.9, 0.999),
               'capturable': False,
               'class': 'optim.Adam',
               'differentiable': False,
               'eps': 1e-08,
               'foreach': None,
               'fused': None,
               'lr': 0.005,
               'maximize': False,
               'weight_decay': 0},
 'scheduler': None,
 'task': {'adversarial_temperature': 0.5,
          'class': 'tasks.KnowledgeGraphCompletion',
          'criterion': 'bce',
          'fact_ratio': None,
          'filtered_ranking': True,
          'full_batch_eval': False,
          'margin': 6,
          'metric': ('mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'),
          'model': {'activation': 'relu',
                    'aggregate_func': 'pna',
                    'class': 'model.NBFNet',
                    'concat_hidden': False,
                    'dependent': True,
                    'hidden_dims': [32, 32, 32, 32, 32, 32],
                    'input_dim': 32,
                    'layer_norm': True,
                    'message_func': 'distmult',
                    'num_beam': 10,
                    'num_mlp_layer': 2,
                    'num_relation': tensor(7),
                    'path_topk': 10,
                    'remove_one_hop': False,
                    'short_cut': True,
                    'symmetric': True},
          'num_negative': 32,
          'sample_weight': False,
          'strict_negative': True},
 'test_set': {'class': 'dataset.Subset',
              'dataset': {'class': 'datasets.LncTarD',
                          'fact_as_train': False,
                          'include_factgraph': False,
                          'path': '/home/linkpred/NBFNet/data/lnctard',
                          'verbose': 1},
              'indices': range(5922, 6580)},
 'train_set': {'class': 'dataset.Subset',
               'dataset': {'class': 'datasets.LncTarD',
                           'fact_as_train': False,
                           'include_factgraph': False,
                           'path': '/home/linkpred/NBFNet/data/lnctard',
                           'verbose': 1},
               'indices': range(0, 5264)},
 'valid_set': {'class': 'dataset.Subset',
               'dataset': {'class': 'datasets.LncTarD',
                           'fact_as_train': False,
                           'include_factgraph': False,
                           'path': '/home/linkpred/NBFNet/data/lnctard',
                           'verbose': 1},
               'indices': range(5264, 5922)}}
16:59:12   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:59:12   Epoch 0 begin
16:59:14   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:59:14   binary cross entropy: 0.712714
16:59:23   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:59:23   Epoch 0 end
16:59:23   duration: 10.60 secs
16:59:23   speed: 9.43 batch / sec
16:59:23   ETA: 10.60 secs
16:59:23   max GPU memory: 1957.6 MiB
16:59:23   ------------------------------
16:59:23   average binary cross entropy: 0.62599
16:59:23   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:59:23   Epoch 1 begin
16:59:23   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:59:23   binary cross entropy: 0.607068
16:59:31   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:59:31   Epoch 1 end
16:59:31   duration: 8.51 secs
16:59:31   speed: 11.75 batch / sec
16:59:31   ETA: 0.00 secs
16:59:31   max GPU memory: 1957.6 MiB
16:59:31   ------------------------------
16:59:31   average binary cross entropy: 0.620837
16:59:31   Save checkpoint to model_epoch_2.pth
16:59:31   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:59:31   Evaluate on valid
17:01:51   ------------------------------
17:01:51   hits@1: 0.0630699
17:01:51   hits@10: 0.293313
17:01:51   hits@3: 0.1269
17:01:51   mr: 173.981
17:01:51   mrr: 0.133885
17:01:51   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:01:51   Epoch 2 begin
17:01:51   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:01:51   binary cross entropy: 0.594968
17:02:00   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:02:00   Epoch 2 end
17:02:00   duration: 2.48 mins
17:02:00   speed: 0.67 batch / sec
17:02:00   ETA: 2.48 mins
17:02:00   max GPU memory: 1958.2 MiB
17:02:00   ------------------------------
17:02:00   average binary cross entropy: 0.619969
17:02:00   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:02:00   Epoch 3 begin
17:02:00   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:02:00   binary cross entropy: 0.584321
17:02:09   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:02:09   Epoch 3 end
17:02:09   duration: 8.84 secs
17:02:09   speed: 11.32 batch / sec
17:02:09   ETA: 0.00 secs
17:02:09   max GPU memory: 1958.2 MiB
17:02:09   ------------------------------
17:02:09   average binary cross entropy: 0.621692
17:02:09   Save checkpoint to model_epoch_4.pth
17:02:09   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:02:09   Evaluate on valid
17:04:31   ------------------------------
17:04:31   hits@1: 0.06231
17:04:31   hits@10: 0.31535
17:04:31   hits@3: 0.142857
17:04:31   mr: 168.278
17:04:31   mrr: 0.139094
17:04:31   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:04:31   Epoch 4 begin
17:04:31   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:04:31   binary cross entropy: 0.602553
17:04:40   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:04:40   Epoch 4 end
17:04:40   duration: 2.51 mins
17:04:40   speed: 0.66 batch / sec
17:04:40   ETA: 2.51 mins
17:04:40   max GPU memory: 1958.2 MiB
17:04:40   ------------------------------
17:04:40   average binary cross entropy: 0.620181
17:04:40   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:04:40   Epoch 5 begin
17:04:40   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:04:40   binary cross entropy: 0.629644
17:04:48   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:04:48   Epoch 5 end
17:04:48   duration: 8.33 secs
17:04:48   speed: 12.01 batch / sec
17:04:48   ETA: 0.00 secs
17:04:48   max GPU memory: 1958.2 MiB
17:04:48   ------------------------------
17:04:48   average binary cross entropy: 0.61863
17:04:48   Save checkpoint to model_epoch_6.pth
17:04:48   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:04:48   Evaluate on valid
17:07:08   ------------------------------
17:07:08   hits@1: 0.0630699
17:07:08   hits@10: 0.319149
17:07:08   hits@3: 0.145897
17:07:08   mr: 169.544
17:07:08   mrr: 0.140486
17:07:08   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:07:08   Epoch 6 begin
17:07:08   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:07:08   binary cross entropy: 0.590945
17:07:16   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:07:16   Epoch 6 end
17:07:16   duration: 2.47 mins
17:07:16   speed: 0.67 batch / sec
17:07:16   ETA: 2.47 mins
17:07:16   max GPU memory: 1958.2 MiB
17:07:16   ------------------------------
17:07:16   average binary cross entropy: 0.618552
17:07:16   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:07:16   Epoch 7 begin
17:07:16   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:07:16   binary cross entropy: 0.678489
17:07:25   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:07:25   Epoch 7 end
17:07:25   duration: 8.33 secs
17:07:25   speed: 12.01 batch / sec
17:07:25   ETA: 0.00 secs
17:07:25   max GPU memory: 1958.2 MiB
17:07:25   ------------------------------
17:07:25   average binary cross entropy: 0.612217
17:07:25   Save checkpoint to model_epoch_8.pth
17:07:25   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:07:25   Evaluate on valid
17:09:45   ------------------------------
17:09:45   hits@1: 0.0691489
17:09:45   hits@10: 0.31155
17:09:45   hits@3: 0.150456
17:09:45   mr: 164.433
17:09:45   mrr: 0.145749
17:09:45   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:09:45   Epoch 8 begin
17:09:45   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:09:45   binary cross entropy: 0.61508
17:09:53   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:09:53   Epoch 8 end
17:09:53   duration: 2.48 mins
17:09:53   speed: 0.67 batch / sec
17:09:53   ETA: 2.48 mins
17:09:53   max GPU memory: 1958.2 MiB
17:09:53   ------------------------------
17:09:53   average binary cross entropy: 0.614967
17:09:53   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:09:53   Epoch 9 begin
17:09:53   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:09:53   binary cross entropy: 0.580353
17:10:02   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:10:02   Epoch 9 end
17:10:02   duration: 8.37 secs
17:10:02   speed: 11.94 batch / sec
17:10:02   ETA: 0.00 secs
17:10:02   max GPU memory: 1958.2 MiB
17:10:02   ------------------------------
17:10:02   average binary cross entropy: 0.616156
17:10:02   Save checkpoint to model_epoch_10.pth
17:10:02   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:10:02   Evaluate on valid
17:12:22   ------------------------------
17:12:22   hits@1: 0.0607903
17:12:22   hits@10: 0.332827
17:12:22   hits@3: 0.149696
17:12:22   mr: 165.179
17:12:22   mrr: 0.143526
17:12:22   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:12:22   Epoch 10 begin
17:12:23   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:12:23   binary cross entropy: 0.683989
17:12:31   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:12:31   Epoch 10 end
17:12:31   duration: 2.49 mins
17:12:31   speed: 0.67 batch / sec
17:12:31   ETA: 2.49 mins
17:12:31   max GPU memory: 1958.2 MiB
17:12:31   ------------------------------
17:12:31   average binary cross entropy: 0.613435
17:12:31   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:12:31   Epoch 11 begin
17:12:31   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:12:31   binary cross entropy: 0.511683
17:12:39   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:12:39   Epoch 11 end
17:12:39   duration: 8.52 secs
17:12:39   speed: 11.74 batch / sec
17:12:39   ETA: 0.00 secs
17:12:39   max GPU memory: 1958.2 MiB
17:12:39   ------------------------------
17:12:39   average binary cross entropy: 0.615102
17:12:39   Save checkpoint to model_epoch_12.pth
17:12:39   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:12:39   Evaluate on valid
17:15:00   ------------------------------
17:15:00   hits@1: 0.0630699
17:15:00   hits@10: 0.321429
17:15:00   hits@3: 0.147416
17:15:00   mr: 165.47
17:15:00   mrr: 0.142355
17:15:00   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:15:00   Epoch 12 begin
17:15:00   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:15:00   binary cross entropy: 0.620226
17:15:08   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:15:08   Epoch 12 end
17:15:08   duration: 2.48 mins
17:15:08   speed: 0.67 batch / sec
17:15:08   ETA: 2.48 mins
17:15:08   max GPU memory: 1958.2 MiB
17:15:08   ------------------------------
17:15:08   average binary cross entropy: 0.609365
17:15:08   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:15:08   Epoch 13 begin
17:15:08   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:15:08   binary cross entropy: 0.540763
17:15:17   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:15:17   Epoch 13 end
17:15:17   duration: 8.36 secs
17:15:17   speed: 11.96 batch / sec
17:15:17   ETA: 0.00 secs
17:15:17   max GPU memory: 1958.2 MiB
17:15:17   ------------------------------
17:15:17   average binary cross entropy: 0.610685
17:15:17   Save checkpoint to model_epoch_14.pth
17:15:17   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:15:17   Evaluate on valid
17:17:37   ------------------------------
17:17:37   hits@1: 0.0645897
17:17:37   hits@10: 0.322188
17:17:37   hits@3: 0.147416
17:17:37   mr: 159.099
17:17:37   mrr: 0.142859
17:17:37   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:17:37   Epoch 14 begin
17:17:37   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:17:37   binary cross entropy: 0.668068
17:17:46   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:17:46   Epoch 14 end
17:17:46   duration: 2.48 mins
17:17:46   speed: 0.67 batch / sec
17:17:46   ETA: 2.48 mins
17:17:46   max GPU memory: 1958.2 MiB
17:17:46   ------------------------------
17:17:46   average binary cross entropy: 0.610852
17:17:46   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:17:46   Epoch 15 begin
17:17:46   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:17:46   binary cross entropy: 0.667842
17:17:54   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:17:54   Epoch 15 end
17:17:54   duration: 8.37 secs
17:17:54   speed: 11.94 batch / sec
17:17:54   ETA: 0.00 secs
17:17:54   max GPU memory: 1958.2 MiB
17:17:54   ------------------------------
17:17:54   average binary cross entropy: 0.618732
17:17:54   Save checkpoint to model_epoch_16.pth
17:17:54   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:17:54   Evaluate on valid
17:20:15   ------------------------------
17:20:15   hits@1: 0.0661094
17:20:15   hits@10: 0.329787
17:20:15   hits@3: 0.154255
17:20:15   mr: 166.145
17:20:15   mrr: 0.148022
17:20:15   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:20:15   Epoch 16 begin
17:20:15   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:20:15   binary cross entropy: 0.578021
17:20:23   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:20:23   Epoch 16 end
17:20:23   duration: 2.48 mins
17:20:23   speed: 0.67 batch / sec
17:20:23   ETA: 2.48 mins
17:20:23   max GPU memory: 1958.2 MiB
17:20:23   ------------------------------
17:20:23   average binary cross entropy: 0.609996
17:20:23   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:20:23   Epoch 17 begin
17:20:23   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:20:23   binary cross entropy: 0.612498
17:20:31   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:20:31   Epoch 17 end
17:20:31   duration: 8.31 secs
17:20:31   speed: 12.03 batch / sec
17:20:31   ETA: 0.00 secs
17:20:31   max GPU memory: 1958.2 MiB
17:20:31   ------------------------------
17:20:31   average binary cross entropy: 0.611449
17:20:31   Save checkpoint to model_epoch_18.pth
17:20:31   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:20:31   Evaluate on valid
17:22:51   ------------------------------
17:22:51   hits@1: 0.0645897
17:22:51   hits@10: 0.317629
17:22:51   hits@3: 0.158055
17:22:51   mr: 165.354
17:22:51   mrr: 0.147964
17:22:51   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:22:51   Epoch 18 begin
17:22:51   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:22:51   binary cross entropy: 0.574046
17:23:00   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:23:00   Epoch 18 end
17:23:00   duration: 2.47 mins
17:23:00   speed: 0.67 batch / sec
17:23:00   ETA: 2.47 mins
17:23:00   max GPU memory: 1958.2 MiB
17:23:00   ------------------------------
17:23:00   average binary cross entropy: 0.613243
17:23:00   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:23:00   Epoch 19 begin
17:23:00   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:23:00   binary cross entropy: 0.545133
17:23:08   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:23:08   Epoch 19 end
17:23:08   duration: 8.34 secs
17:23:08   speed: 12.00 batch / sec
17:23:08   ETA: 0.00 secs
17:23:08   max GPU memory: 1958.2 MiB
17:23:08   ------------------------------
17:23:08   average binary cross entropy: 0.608376
17:23:08   Save checkpoint to model_epoch_20.pth
17:23:08   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:23:08   Evaluate on valid
17:25:30   ------------------------------
17:25:30   hits@1: 0.0699088
17:25:30   hits@10: 0.319909
17:25:30   hits@3: 0.144377
17:25:30   mr: 161.305
17:25:30   mrr: 0.147608
17:25:30   Load checkpoint from model_epoch_16.pth
17:25:30   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:25:30   Evaluate on valid
17:27:50   ------------------------------
17:27:50   hits@1: 0.0661094
17:27:50   hits@10: 0.329787
17:27:50   hits@3: 0.154255
17:27:50   mr: 166.145
17:27:50   mrr: 0.148022
17:27:50   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:27:50   Evaluate on test
17:30:10   ------------------------------
17:30:10   hits@1: 0.0653495
17:30:10   hits@10: 0.308511
17:30:10   hits@3: 0.141337
17:30:10   mr: 209.422
17:30:10   mrr: 0.140262
