23:39:53   Config file: config/knowledge_graph/lnctard2_visualize.yaml
23:39:53   {'checkpoint': '/home/linkpred/NBFNet/results/LncTarD2/KnowledgeGraphCompletionBiomed/LncTarD2/NBFNet/2023-07-05-23-17-09-042359/model_epoch_5.pth',
 'dataset': {'class': 'LncTarD2',
             'include_factgraph': True,
             'path': '/home/linkpred/NBFNet/data/lnctard'},
 'engine': {'batch_size': 4, 'gpus': [0]},
 'metric': 'mrr',
 'optimizer': {'class': 'Adam', 'lr': 0.005},
 'output_dir': 'results/LncTarD2',
 'task': {'adversarial_temperature': 0.5,
          'class': 'KnowledgeGraphCompletionBiomed',
          'conditional_probability': True,
          'criterion': 'bce',
          'full_batch_eval': False,
          'heterogeneous_evaluation': True,
          'heterogeneous_negative': True,
          'model': {'aggregate_func': 'pna',
                    'class': 'NBFNet',
                    'dependent': True,
                    'hidden_dims': [32, 32, 32, 32, 32, 32],
                    'input_dim': 32,
                    'layer_norm': True,
                    'message_func': 'distmult',
                    'short_cut': True,
                    'symmetric': True},
          'num_negative': 32,
          'sample_weight': False,
          'strict_negative': True}}
23:39:53   LncTarD2(
  #entity: 2963
  #relation: 7
  #triplet: 6580
)
23:39:53   #train: 1053, #valid: 658, #test: 658
23:39:53   Preprocess training set
23:39:55   {'batch_size': 4,
 'class': 'core.Engine',
 'gpus': [0],
 'gradient_interval': 1,
 'log_interval': 100,
 'logger': 'logging',
 'num_worker': 0,
 'optimizer': {'amsgrad': False,
               'betas': (0.9, 0.999),
               'capturable': False,
               'class': 'optim.Adam',
               'differentiable': False,
               'eps': 1e-08,
               'foreach': None,
               'fused': None,
               'lr': 0.005,
               'maximize': False,
               'weight_decay': 0},
 'scheduler': None,
 'task': {'adversarial_temperature': 0.5,
          'class': 'tasks.KnowledgeGraphCompletionBiomed',
          'criterion': 'bce',
          'fact_ratio': None,
          'filtered_ranking': True,
          'full_batch_eval': False,
          'margin': 6,
          'metric': ('mr', 'mrr', 'hits@1', 'hits@3', 'hits@10', 'hits@100'),
          'model': {'activation': 'relu',
                    'aggregate_func': 'pna',
                    'class': 'model.NBFNet',
                    'concat_hidden': False,
                    'dependent': True,
                    'hidden_dims': [32, 32, 32, 32, 32, 32],
                    'input_dim': 32,
                    'layer_norm': True,
                    'message_func': 'distmult',
                    'num_beam': 10,
                    'num_mlp_layer': 2,
                    'num_relation': tensor(7),
                    'path_topk': 10,
                    'remove_one_hop': False,
                    'short_cut': True,
                    'symmetric': True},
          'num_negative': 32,
          'sample_weight': False,
          'strict_negative': True},
 'test_set': {'class': 'dataset.Subset',
              'dataset': {'class': 'datasets.LncTarD2',
                          'fact_as_train': False,
                          'include_factgraph': True,
                          'path': '/home/linkpred/NBFNet/data/lnctard',
                          'verbose': 1},
              'indices': range(5922, 6580)},
 'train_set': {'class': 'dataset.Subset',
               'dataset': {'class': 'datasets.LncTarD2',
                           'fact_as_train': False,
                           'include_factgraph': True,
                           'path': '/home/linkpred/NBFNet/data/lnctard',
                           'verbose': 1},
               'indices': range(4211, 5264)},
 'valid_set': {'class': 'dataset.Subset',
               'dataset': {'class': 'datasets.LncTarD2',
                           'fact_as_train': False,
                           'include_factgraph': True,
                           'path': '/home/linkpred/NBFNet/data/lnctard',
                           'verbose': 1},
               'indices': range(5264, 5922)}}
23:39:55   Load checkpoint from /home/linkpred/NBFNet/results/LncTarD2/KnowledgeGraphCompletionBiomed/LncTarD2/NBFNet/2023-07-05-23-17-09-042359/model_epoch_5.pth
